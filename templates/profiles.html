<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grow Profiles</title>

  <!-- fonts & icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Make the page responsive like your working template -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    
    /* === Pulsing border for the active (running) profile only === */
.row.is-current{
  position: relative;        /* anchor the glow */
  border-radius: 8px;        /* match your row radius */
  z-index: 1;
}

.row.is-current::after{
  content:"";
  position:absolute;
  inset:0;                   /* sit exactly on the row’s edge */
  border-radius: inherit;
  pointer-events:none;
  box-shadow: 0 0 0 0 rgba(30, 92, 255, 0.45);   /* blue glow */
  animation: glowPulse 1.8s ease-out infinite;
}

.row.is-current.is-paused::after{
  box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.45);  /* amber when paused */
}

@keyframes glowPulse{
  0%   { box-shadow: 0 0 0 0   rgba(30, 92, 255, 0.45); }
  70%  { box-shadow: 0 0 0 15px rgba(30, 92, 255, 0.00); }
  100% { box-shadow: 0 0 0 0   rgba(30, 92, 255, 0.00); }
}

    
    :root{
      /* Settings-page tokens */
      --bg:#0b0f14; --card:#121925; --muted:#2a3950; --text:#e7eef7; --sub:#e7eef7; --hint:#9bb4d3;
      --brand:#1e5cff;
      --radius: 8px;
      --pad: 14px;
      --section-gap: 26px;
      --w: 850px;
    }

    /* reset */
    *, *::before, *::after { box-sizing: border-box; }
    html,body{height:100%; margin:0; padding:0;}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Open Sans', sans-serif;
      background: var(--bg); color: var(--text);
    }

    /* Constrain any included header horizontally (no functional change) */
    header, .header2, .site-header, nav.header, nav.top, .topnav {
      max-width: var(--w);
      margin: 0 auto;
      padding: 0 var(--pad);
    }

    /* container */
    .main-container{
      max-width: var(--w);
      margin: 28px auto 64px;
      padding: 0 var(--pad) 50px;
    }

    h1{ font-size:24px; font-weight:600; margin:0 0 18px 0; }
    h2{ font-size:14px; font-weight:700; margin:28px 0 10px 0; text-transform:uppercase; color:var(--sub); }

    /* list/cards */
    .list{
      border:1px solid var(--muted);
      border-radius: var(--radius);
      overflow: visible;
      background: var(--card);
      margin-top:20px;
    }
    .row{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 14px; border-bottom:1px solid var(--muted);
      flex-wrap: wrap;
    }
    .row:last-child{ border-bottom:none; }
    .row-left{ display:flex; align-items:center; gap:10px; font-weight:600; color:var(--text); }

    /* active profile emphasis (subtle, consistent with settings) */
    .row.is-current{
      border: 1px solid #2f4470;  /* subtle blue edge */
      border-radius: var(--radius);
      background: #0d1420; /* same input-bg used on settings pages */
    }

    /* chips */
    .chip{ font-size:12px; font-weight:700; padding:4px 8px; border-radius:999px; border:1px solid var(--muted); }
    .chip-current{ background:#0d1420; color:#cde4ff; }
    .chip-running{ background:#ADFB13; color:#121212; border-color:#ADFB13; }
    .chip-paused{ background:#1f2a3d; color:#f8d9a6; border-color:#3a4a64; }
    .chip-restored{ background:#1e5cff; color:#ffffff; }


    /* right-aligned controls */
    .row-right{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
    .row-right form{ margin:0; }

    /* buttons (aligned with settings: blue primary, grey “nav”) */
    .btn{
      display:inline-flex; align-items:center; gap:6px; font-size:13px; font-weight:600;
      padding:10px 14px; border-radius: var(--radius); border:1px solid var(--muted);
      background: var(--card); color:#ddd; text-decoration:none; cursor:pointer;
      transition: filter .12s ease-in-out;
    }
    .btn:hover{ filter:brightness(0.95); }

    /* keep your semantic colours but in dark theme hues */
    .btn-quiet-blue   { background: var(--card); color:#cde4ff; border-color:#2a3950; }
    .btn-quiet-green  { background: var(--card); color:#cfe9d8; border-color:#2a3950; }
    .btn-quiet-amber  { background: var(--card); color:#ffe0b8; border-color:#2a3950; }
    .btn-quiet-red    { background: var(--card); color:#f6c9c4; border-color:#2a3950; }

    /* hover-only for non-active list rows */
    .btn-hover-quiet-blue:hover  { color:#cde4ff; }
    .btn-hover-quiet-green:hover { color:#cfe9d8; }
    .btn-hover-quiet-amber:hover { color:#ffe0b8; }
    .btn-hover-quiet-red:hover   { color:#f6c9c4; }

    /* status dot */
    .dot{
      width:8px; height:8px; border-radius:50%; background:#22c55e;
      box-shadow:0 0 0 0 rgba(34,197,94,0.4);
      animation:pulse 1.8s ease-out infinite;
      margin-left:2px;
    }
    .is-paused .dot{ background:#f59e0b; box-shadow:0 0 0 0 rgba(245,158,11,0.4); }
    @keyframes pulse{
      0% { box-shadow:0 0 0 0 rgba(34,197,94,0.4); }
      70%{ box-shadow:0 0 0 10px rgba(34,197,94,0); }
      100%{ box-shadow:0 0 0 0 rgba(34,197,94,0); }
    }

    /* empty states */
    .empty{
      background:#0d1420; border:1px solid var(--muted); color:var(--hint);
      padding:12px 14px; border-radius: var(--radius);
    }
    
    /* Title bar with right-aligned button */
.title-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 18px;
  flex-wrap: wrap;
  gap: 10px;
}

/* Bright blue 'Create' button */
.btn-create {
  background: var(--brand);
  color: #fff;
  border: 1px solid var(--brand);
  transition: background 0.15s ease, filter 0.15s ease;
  font-size: 12px;
}

.btn-create:hover {
  filter: brightness(1.15);
}


  </style>
</head>

<body>
  <!-- HEADER -->
  {% include "header2.html" %}
  

  <!-- MAIN -->
  <div class="main-container">
    <div class="title-bar">
  <h1>Saved Grow Profiles</h1>
  <a href="/new" class="btn btn-create">
    <i class="fa-solid fa-plus"></i> Create New Profile
  </a>
  </div>

    
      {% if resume_candidate and not running_profile and resume_candidate.get('running_profile') %}
  <div class="empty" style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
    <span>
      Previous run detected:
      <strong>{{ resume_candidate['running_profile'] }}</strong>.
      Resume it?
    </span>
    <form action="/resume" method="POST" style="margin:0;">
      <button type="submit" class="btn btn-quiet-green">
        <i class="fa-solid fa-rotate-right"></i> Resume
      </button>
    </form>
    <form action="/dismiss-resume" method="POST" style="margin:0;">
      <button type="submit" class="btn">
        Dismiss
      </button>
    </form>
  </div>
{% endif %}


    <!-- Current Active Profile -->
    <h2>Current Active Profile</h2>
    {% if running_profile %}
      <div class="list section">
        <div class="row is-current {% if paused %}is-paused{% endif %}">
          <div class="row-left">
            <span class="dot"></span>
            {{ running_profile }}
            <span class="chip chip-current">Current</span>
            {% if paused %}
              <span class="chip chip-paused">Paused</span>
            {% else %}
              <span class="chip chip-running">Running</span>
            {% endif %}
          </div>
          <div class="row-right">
            {% if paused %}
              <form action="/unpause" method="POST">
                <button type="submit" class="btn btn-quiet-green"><i class="fa-solid fa-play"></i> Continue</button>
              </form>
            {% else %}
              <form action="/pause" method="POST">
                <button type="submit" class="btn btn-quiet-amber"><i class="fa-solid fa-pause"></i> Pause</button>
              </form>
            {% endif %}
            <form action="/stop" method="POST">
              <button type="submit" class="btn btn-quiet-red" onclick="return confirm('Are you sure you want to stop this profile?')"><i class="fa-solid fa-stop"></i> Stop</button>
            </form>
            <a href="/edit/{{ running_profile }}" class="btn btn-quiet-blue"><i class="fa-solid fa-pen-to-square"></i> Edit</a>
            <form action="/duplicate/{{ running_profile }}" method="POST">
  <button type="submit" class="btn btn-hover-quiet-blue">
    <i class="fa-solid fa-copy"></i> Duplicate
  </button>
</form>

          </div>
        </div>
      </div>
    {% else %}
      <div class="empty">No profile is currently running.</div>
    {% endif %}

    <!-- Other Profiles -->
    <h2>Other Profiles</h2>
    {% set others = profiles | reject('equalto', running_profile) | list %}
    {% if others|length == 0 %}
      <div class="empty">No other saved profiles.</div>
    {% else %}
      <div class="list section">
        {% for profile in others %}
  <div class="row">
    <div class="row-left">
      {{ profile }}
      {% if request.args.get('restored') == profile %}
        <span class="chip chip-restored">Restored</span>
      {% endif %}
    </div>
    <div class="row-right">

              <form action="/run/{{ profile }}" method="POST">
                <button type="submit" class="btn btn-hover-quiet-green"><i class="fa-solid fa-play"></i> Run</button>
              </form>
              <a href="/edit/{{ profile }}" class="btn btn-hover-quiet-blue"><i class="fa-solid fa-pen-to-square"></i> Edit</a>
              <form action="/duplicate/{{ profile }}" method="POST">
  <button type="submit" class="btn btn-hover-quiet-blue">
    <i class="fa-solid fa-copy"></i> Duplicate
  </button>
</form>

              <form action="/delete/{{ profile }}" method="POST">
                <button type="submit" class="btn btn-hover-quiet-red" onclick="return confirm('Archive this profile? It can be restored any time from the archive page.')">
                  <i class="fa-solid fa-trash"></i> Archive
                </button>
              </form>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    <div style="text-align:left; margin-top:20px;padding-top:20px; border-top:1px solid #2a3950;">
  <a href="/archive" class="btn btn-quiet-blue">
    <i class="fa-solid fa-box-archive"></i> View Archived Profiles
  </a>
</div>

  </div>
</body>
</html>



